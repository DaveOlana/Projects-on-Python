<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CalendME - Smart Schedule Builder</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <meta name="theme-color" content="#007AFF">
    <meta name="description" content="Create and organize your schedule with natural language">
</head>

<body data-theme="light">
    <!-- Header -->
    <header class="app-header">
        <div class="header-left">
            <div class="logo-container">
                <svg class="logo-icon" width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <rect x="4" y="6" width="24" height="22" rx="3" stroke="currentColor" stroke-width="2" />
                    <line x1="4" y1="12" x2="28" y2="12" stroke="currentColor" stroke-width="2" />
                    <circle cx="11" cy="18" r="1.5" fill="currentColor" />
                    <circle cx="16" cy="18" r="1.5" fill="currentColor" />
                    <circle cx="21" cy="18" r="1.5" fill="currentColor" />
                    <circle cx="11" cy="23" r="1.5" fill="currentColor" />
                    <circle cx="16" cy="23" r="1.5" fill="currentColor" />
                </svg>
                <h1 class="logo-text">CalendME</h1>
            </div>
        </div>

        <div class="header-right">
            <button class="icon-btn" id="save-json-btn" title="Save Schedule">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path
                        d="M4 16V4C4 3.44772 4.44772 3 5 3H15C15.5523 3 16 3.44772 16 4V16M4 16C4 16.5523 4.44772 17 5 17H15C15.5523 17 16 16.5523 16 16M4 16L8 12M16 16L12 12M8 12L10 10L12 12M8 12V7M12 12V7"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </button>
            <button class="icon-btn" id="load-json-btn" title="Load Schedule">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path
                        d="M4 4V16C4 16.5523 4.44772 17 5 17H15C15.5523 17 16 16.5523 16 16V4M4 4C4 3.44772 4.44772 3 5 3H15C15.5523 3 16 3.44772 16 3C16 3.55228 16 4M4 4L8 8M16 4L12 8M8 8L10 10L12 8M8 8V13M12 8V13"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </button>
            <button class="icon-btn theme-toggle" id="theme-toggle" title="Switch Theme">
                <svg class="theme-icon sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <circle cx="10" cy="10" r="3" stroke="currentColor" stroke-width="1.5" />
                    <path
                        d="M10 1V3M10 17V19M19 10H17M3 10H1M16.364 16.364L14.95 14.95M5.05 5.05L3.636 3.636M16.364 3.636L14.95 5.05M5.05 14.95L3.636 16.364"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                </svg>
                <svg class="theme-icon moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                    style="display: none;">
                    <path
                        d="M17 10.5C17 14.6421 13.6421 18 9.5 18C5.35786 18 2 14.6421 2 10.5C2 6.35786 5.35786 3 9.5 3C9.67167 3 9.84202 3.00672 10.011 3.02002C8.7786 4.17692 8 5.82297 8 7.66667C8 11.1645 10.8355 14 14.3333 14C15.7303 14 17.0123 13.5209 18.02 12.7074C17.7056 13.9489 17.1272 15.0927 16.3431 16.0784"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <svg class="theme-icon auto-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                    style="display: none;">
                    <path
                        d="M2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10Z"
                        fill="currentColor" fill-opacity="0.1" stroke="currentColor" stroke-width="1.5" />
                    <path d="M10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18" stroke="currentColor"
                        stroke-width="1.5" />
                </svg>
            </button>
            <button class="icon-btn" id="clear-all-btn" title="Clear All Events">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path
                        d="M3 5H17M8 9V15M12 9V15M7 5V3C7 2.44772 7.44772 2 8 2H12C12.5523 2 13 2.44772 13 3V5M4 5H16V17C16 17.5523 15.5523 18 15 18H5C4.44772 18 4 17.5523 4 17V5Z"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Floating Quick Add Card -->
        <section class="quick-add-card">
            <div class="quick-add-header">
                <h2>Add Event</h2>
                <p class="quick-add-hint">Try: "Monday 10am Team Meeting for 2 hours"</p>
            </div>

            <div class="quick-add-form">
                <input type="text" id="natural-input" class="natural-input" placeholder="Tomorrow 3pm Football match..."
                    autocomplete="off" />

                <div class="priority-selector">
                    <label class="priority-label">Priority:</label>
                    <button class="priority-btn" data-priority="red" title="Urgent">
                        <span class="priority-dot red"></span>
                    </button>
                    <button class="priority-btn" data-priority="yellow" title="Important">
                        <span class="priority-dot yellow"></span>
                    </button>
                    <button class="priority-btn active" data-priority="green" title="Normal">
                        <span class="priority-dot green"></span>
                    </button>
                </div>

                <button class="add-event-btn" id="add-event-btn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    </svg>
                    Add Event
                </button>
            </div>

            <div class="parse-feedback" id="parse-feedback"></div>
        </section>

        <!-- Events Container -->
        <section class="events-section">
            <div class="events-header">
                <h3>Your Schedule</h3>
                <span class="event-count" id="event-count">0 events</span>
            </div>

            <div class="events-container" id="events-container">
                <!-- Empty State -->
                <div class="empty-state" id="empty-state">
                    <svg width="64" height="64" viewBox="0 0 64 64" fill="none" class="empty-icon">
                        <rect x="12" y="16" width="40" height="38" rx="4" stroke="currentColor" stroke-width="2.5"
                            opacity="0.3" />
                        <line x1="12" y1="26" x2="52" y2="26" stroke="currentColor" stroke-width="2.5" opacity="0.3" />
                        <circle cx="22" cy="34" r="2" fill="currentColor" opacity="0.3" />
                        <circle cx="32" cy="34" r="2" fill="currentColor" opacity="0.3" />
                        <circle cx="42" cy="34" r="2" fill="currentColor" opacity="0.3" />
                        <circle cx="22" cy="42" r="2" fill="currentColor" opacity="0.3" />
                        <circle cx="32" cy="42" r="2" fill="currentColor" opacity="0.3" />
                    </svg>
                    <p class="empty-text">No events yet</p>
                    <p class="empty-subtext">Start building your schedule above</p>
                </div>

                <!-- Events will be dynamically inserted here -->
            </div>
        </section>

        <!-- Export Section -->
        <section class="export-section">
            <button class="export-btn" id="export-ics-btn" disabled>
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path
                        d="M4 14V17C4 17.5523 4.44772 18 5 18H15C15.5523 18 16 17.5523 16 17V14M10 12V2M10 12L7 9M10 12L13 9"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                Generate Calendar (.ics)
            </button>

            <button class="import-guide-btn" id="import-guide-btn">
                <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
                    <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1.5" />
                    <path d="M10 14V10M10 6H10.01" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                </svg>
                Import guide to calendar
            </button>
        </section>
    </main>

    <!-- Hidden File Input for JSON Import -->
    <input type="file" id="json-file-input" accept=".json" style="display: none;">

    <!-- Duration Picker Modal (will be shown when needed) -->
    <div class="modal-overlay" id="duration-modal" style="display: none;">
        <div class="modal-content duration-picker-modal">
            <div class="modal-header">
                <h3>Set Duration</h3>
                <button class="modal-close" id="close-duration-modal">√ó</button>
            </div>
            <div class="duration-picker">
                <div class="time-column">
                    <label>Hours</label>
                    <div class="time-scroll" id="hours-scroll">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
                <div class="time-separator">:</div>
                <div class="time-column">
                    <label>Minutes</label>
                    <div class="time-scroll" id="minutes-scroll">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>
            <button class="modal-confirm" id="confirm-duration">Confirm</button>
        </div>
    </div>

    <!-- Edit Event Modal -->
    <div class="modal-overlay" id="edit-modal" style="display: none;">
        <div class="modal-content edit-modal">
            <div class="modal-header">
                <h3>Edit Event</h3>
                <button class="modal-close" id="close-edit-modal">√ó</button>
            </div>
            <form class="edit-form" id="edit-form">
                <div class="form-group">
                    <label for="edit-title">Event Title</label>
                    <input type="text" id="edit-title" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-date">Date</label>
                        <input type="date" id="edit-date" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-priority">Priority</label>
                        <select id="edit-priority">
                            <option value="red">üî¥ Urgent</option>
                            <option value="yellow">üü° Important</option>
                            <option value="green">üü¢ Normal</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-start-time">Start Time</label>
                        <input type="time" id="edit-start-time" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-end-time">End Time</label>
                        <input type="time" id="edit-end-time" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="edit-notes">Notes (Optional)</label>
                    <textarea id="edit-notes" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancel-edit">Cancel</button>
                    <button type="submit" class="btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Import Guide Modal -->
    <div class="modal-overlay" id="import-guide-modal" style="display: none;">
        <div class="modal-content import-guide-modal">
            <div class="modal-header">
                <h3>üìñ How to Import Your Calendar</h3>
                <button class="modal-close" id="close-import-guide">√ó</button>
            </div>

            <div class="guide-tabs">
                <button class="guide-tab active" data-tab="google">üìÖ Google Calendar</button>
                <button class="guide-tab" data-tab="apple">üçé Apple Calendar</button>
                <button class="guide-tab" data-tab="outlook">üìß Outlook</button>
            </div>

            <div class="guide-content">
                <!-- Google Calendar Tab -->
                <div class="guide-panel active" id="google-guide">
                    <h4>Google Calendar Import</h4>

                    <div class="guide-section">
                        <h5>üíª Desktop / Web</h5>
                        <ol class="guide-steps">
                            <li>Go to <a href="https://calendar.google.com" target="_blank">calendar.google.com</a></li>
                            <li>Click the <strong>Settings gear icon ‚öôÔ∏è</strong> (top-right corner)</li>
                            <li>Select <strong>"Settings"</strong> from dropdown</li>
                            <li>In left sidebar, click <strong>"Import & Export"</strong></li>
                            <li>Click <strong>"Select file from your computer"</strong></li>
                            <li>Choose your downloaded <code>.ics</code> file</li>
                            <li>Select which calendar to add events to (usually "Primary")</li>
                            <li>Click <strong>"Import"</strong></li>
                            <li>‚úÖ You'll see confirmation: "Imported X events"</li>
                        </ol>
                    </div>

                    <div class="guide-section">
                        <h5>üì± Mobile (iOS / Android)</h5>
                        <p class="guide-method"><strong>Email Method (Easiest):</strong></p>
                        <ol class="guide-steps">
                            <li>Email the <code>.ics</code> file to yourself</li>
                            <li>Open email on your phone</li>
                            <li>Tap the <code>.ics</code> attachment</li>
                            <li>Tap <strong>"Add All"</strong> or <strong>"Add to Calendar"</strong></li>
                            <li>‚úÖ Events automatically import to Google Calendar</li>
                        </ol>

                        <p class="guide-method"><strong>Google Drive Method:</strong></p>
                        <ol class="guide-steps">
                            <li>Upload <code>.ics</code> file to Google Drive</li>
                            <li>Open file on phone from Google Drive</li>
                            <li>Tap <strong>"Open with Google Calendar"</strong></li>
                            <li>Confirm import</li>
                        </ol>
                    </div>
                </div>

                <!-- Apple Calendar Tab -->
                <div class="guide-panel" id="apple-guide">
                    <h4>Apple Calendar Import</h4>

                    <div class="guide-section">
                        <h5>üíª Mac</h5>
                        <ol class="guide-steps">
                            <li>Double-click the downloaded <code>.ics</code> file</li>
                            <li>Calendar app will open automatically</li>
                            <li>A dialog appears: <strong>"Add events to..."</strong></li>
                            <li>Select which calendar to import to</li>
                            <li>Click <strong>"Add All"</strong></li>
                            <li>‚úÖ All events appear in Calendar app</li>
                        </ol>

                        <p class="guide-tip"><strong>Alternative:</strong> Drag the <code>.ics</code> file directly into
                            Calendar app window</p>
                    </div>

                    <div class="guide-section">
                        <h5>üì± iPhone / iPad</h5>
                        <p class="guide-method"><strong>Email Method (Easiest):</strong></p>
                        <ol class="guide-steps">
                            <li>Email the <code>.ics</code> file to yourself</li>
                            <li>Open Mail app on your iPhone</li>
                            <li>Tap the <code>.ics</code> attachment</li>
                            <li>Tap <strong>"Add All X Events"</strong></li>
                            <li>Choose calendar to add to</li>
                            <li>Tap <strong>"Done"</strong></li>
                            <li>‚úÖ Events sync to Apple Calendar</li>
                        </ol>

                        <p class="guide-method"><strong>iCloud Method:</strong></p>
                        <ol class="guide-steps">
                            <li>Upload <code>.ics</code> to iCloud Drive</li>
                            <li>Open Files app on iPhone</li>
                            <li>Navigate to iCloud Drive</li>
                            <li>Tap the <code>.ics</code> file</li>
                            <li>Tap <strong>"Add All"</strong></li>
                        </ol>
                    </div>
                </div>

                <!-- Outlook Tab -->
                <div class="guide-panel" id="outlook-guide">
                    <h4>Microsoft Outlook Import</h4>

                    <div class="guide-section">
                        <h5>üíª Outlook Desktop (Windows / Mac)</h5>
                        <ol class="guide-steps">
                            <li>Open Outlook application</li>
                            <li>Go to <strong>File</strong> ‚Üí <strong>Open & Export</strong></li>
                            <li>Click <strong>"Import/Export"</strong></li>
                            <li>Select <strong>"Import an iCalendar (.ics) or vCalendar file"</strong></li>
                            <li>Click <strong>"Next"</strong></li>
                            <li>Browse and select your <code>.ics</code> file</li>
                            <li>Choose <strong>"Import"</strong> or <strong>"Open as New"</strong></li>
                            <li>‚úÖ Events added to your Outlook calendar</li>
                        </ol>
                    </div>

                    <div class="guide-section">
                        <h5>üåê Outlook Web (Outlook.com)</h5>
                        <ol class="guide-steps">
                            <li>Go to <a href="https://outlook.live.com/calendar"
                                    target="_blank">outlook.live.com/calendar</a></li>
                            <li>Sign in to your account</li>
                            <li>Click <strong>"Add calendar"</strong> (left sidebar)</li>
                            <li>Select <strong>"Upload from file"</strong></li>
                            <li>Click <strong>"Browse"</strong> and choose your <code>.ics</code> file</li>
                            <li>Click <strong>"Import"</strong></li>
                            <li>‚úÖ Events appear in your calendar</li>
                        </ol>
                    </div>

                    <div class="guide-section">
                        <h5>üì± Outlook Mobile (iOS / Android)</h5>
                        <p class="guide-method"><strong>Email Method:</strong></p>
                        <ol class="guide-steps">
                            <li>Email the <code>.ics</code> file to your Outlook email</li>
                            <li>Open Outlook app on your phone</li>
                            <li>Open the email with attachment</li>
                            <li>Tap the <code>.ics</code> file attachment</li>
                            <li>Tap <strong>"Add to Calendar"</strong></li>
                            <li>Review events and tap <strong>"Save"</strong></li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>